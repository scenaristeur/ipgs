{"version":3,"sources":["webpack:///./src/components/layout/CommandInput.vue?0050","webpack:///src/components/layout/CommandInput.vue","webpack:///./src/components/layout/CommandInput.vue?5fda","webpack:///./src/components/layout/CommandInput.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","scopedSlots","_u","key","fn","proxy","attrs","on","$event","type","indexOf","_k","keyCode","onEnter","model","value","callback","$$v","main_input","expression","staticRenderFns","name","components","data","commandHistory","methods","console","log","inputValue","length","inputObject","getInputType","$store","commit","inputNew","isValidUrl","iv","isFile","traiteTriplet","result","messageCut","forEach","part","trim","startsWith","detectLiteral","messageCutTemp","push","substr","pop","isTriplet","tripletvalue","subject","predicate","object","message","catchTriplet","triplet","updateInput","document","getElementById","pathname","split","URL","string","watch","commandInput","computed","get","set","component"],"mappings":"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","file":"js/chunk-2d216f1a.6ef25df0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-input-group',{scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_c('NetworkToolBar')]},proxy:true}])},[_c('b-form-input',{attrs:{\"id\":\"input\",\"autofocus\":\"\",\"title\":\"type three words followed by a comma\",\"placeholder\":\"/h + Enter for help\"},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onEnter($event)}},model:{value:(_vm.main_input),callback:function ($$v) {_vm.main_input=$$v},expression:\"main_input\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <b-input-group>\n      <b-form-input\n      id=\"input\"\n      autofocus\n      v-model=\"main_input\"\n      v-on:keyup.enter=\"onEnter\"\n      title=\"type three words followed by a comma\"\n      placeholder=\"/h + Enter for help\"></b-form-input>\n\n\n    <template #append>\n        <NetworkToolBar />\n    </template>\n  </b-input-group>\n\n  </template>\n\n<script>\n//https://github.com/scenaristeur/spoggy-simple/blob/cc3738baecea9ee6b3f87f81a70f69e0090cf658/js/spoggy.js#L38\nexport default {\n  name: 'CommandInput',\n  components: {\n    'NetworkToolBar': () => import('@/components/network/NetworkToolBar'),\n  },\n  data() {\n    return {\n      main_input: \"\",\n      commandHistory: []\n    }\n  },\n  methods: {\n    onEnter(){\n      console.log(this.main_input)\n      let inputValue = this.main_input.trim()\n      if (inputValue.length > 0){\n        var inputObject = this.getInputType(inputValue)\n        console.log(\"inputObject\",inputObject);\n        //  this.traiteInput(inputObject);\n        //  this.updateInput(inputObject.inputNew);\n        // this.$emit('onCommand', inputObject)\n        this.$store.commit('ipgs/setInputObject', inputObject)\n        this.main_input = inputObject.inputNew\n      }\n    },\n    getInputType(iv){\n      var inputObject = {};\n\n      // si commence par http --> type = url\n      if (this.isValidUrl(iv)){\n        inputObject.type = \"url\";\n        inputObject.value = iv;\n        inputObject.isFile = this.isFile(iv)\n      }else{\n        // selon le premier charactère, on detecte une commande\n        let firstChar = iv.charAt(0);\n        let last =\"\"\n        switch(firstChar){\n          case '/':\n          //    let commande = rdf.quad(rdf.blankNode(), rdf.namedNode('commande'),rdf.literal(message))\n          //  this.catchCommande(message,this.network,this);\n\n          inputObject.type = \"commande\";\n          inputObject.value = iv;\n          inputObject.inputNew = \"\";\n          //this.catchCommande(inputObject)\n          break;\n\n          case '.':\n          last = this.commandHistory[this.commandHistory.length-1];\n          inputObject.inputNew = last.s+\" \"+last.p+\" \"+last.o;\n          break;\n\n          case ';':\n          last = this.commandHistory[this.commandHistory.length-1];\n          inputObject.inputNew = last.s+\" \"+last.p+\" \";\n          break;\n\n          case ',':\n          last = this.commandHistory[this.commandHistory.length-1];\n          inputObject.inputNew = last.s+\" \";\n          break;\n\n\n          default:\n          // si le premier charactère n'indique pas une commande, on traite comme un triplet\n          inputObject = this.traiteTriplet(iv);\n          this.catchTriplet(inputObject)\n        }\n      }\n\n      //si termine par virgule, point, point-virgule, tiret --> triplet\n\n      return inputObject;\n    },\n    traiteTriplet(message){\n      var result = {}\n      var inputNew = \"\";\n      let lastChar = message.slice(-1);\n      let messageCut = message.slice(0,-1).split(\" \");\n      let isTriplet = true;\n      //  console.log(messageCut);\n\n      let detectLiteral = \"\";\n      let messageCutTemp = [];\n      messageCut.forEach(function(part){\n        part = part.trim();\n        //  console.log(part);\n        if (part.startsWith('\"')){\n          detectLiteral =\"debut\";\n          //  console.log(detectLiteral);\n          messageCutTemp.push(part.substr(1));\n        }else if (part.endsWith('\"')){\n          detectLiteral = \"fin\";\n          //console.log(detectLiteral);\n          messageCutTemp.push(messageCutTemp.pop()+\" \"+part.slice(0,-1));\n        }else if (detectLiteral == \"debut\"){\n          //  console.log(\"recupere le dernier et lui ajoute part\" )\n          messageCutTemp.push(messageCutTemp.pop()+\" \"+part)\n        }else {\n          messageCutTemp.push(part);\n        }\n      });\n      if (messageCutTemp.length > 0){\n        messageCut = messageCutTemp;\n      }\n      switch(lastChar){\n        case '.':\n        inputNew = \"\";\n        break;\n        case ';':\n        if (messageCut[0].indexOf(\" \") > -1){\n          inputNew = '\"'+messageCut[0]+'\"'+' ';\n        }else{\n          inputNew = messageCut[0]+' ';\n        }\n        break;\n        case ',':\n        if (messageCut[0].indexOf(\" \") > -1){\n          inputNew = '\"'+messageCut[0]+'\" ';\n        }else{\n          inputNew = messageCut[0]+' ';\n        }\n        if (messageCut[1].indexOf(\" \") > -1){\n          inputNew += '\"'+messageCut[1]+'\" ';\n        }else{\n          inputNew += messageCut[1]+' ';\n        }\n        break;\n        case '-':\n        if (messageCut[2].indexOf(\" \") > -1){\n          inputNew = '\"'+messageCut[2]+'\"'+' ';\n        }else{\n          inputNew = messageCut[2]+' ';\n        }\n        break;\n        default:\n        console.log(\"message to chat \"+message)\n        //this.sendMessage(message);\n        //  this.agentInput.send('agentSocket', {type: \"sendMessage\", message:message});\n        //  this.catchTriplet(message.slice(0,-1), this.network); // A REMPLACER PAR CATCHTRIPLETS V2\n        inputNew = \"\";\n        isTriplet = false;\n      }\n      if (isTriplet){\n        //  console.log(\"est Triplet\",messageCut)\n        result.type = \"triplet\";\n        var tripletvalue = {};\n        tripletvalue.subject = messageCut[0];\n        tripletvalue.predicate = messageCut[1];\n        tripletvalue.object = messageCut[2];\n        result.value = tripletvalue;\n        result.inputNew = inputNew;\n      }else {\n        //  console.log(\"n'est pas triplet\")\n        result.type = \"message\";\n        result.value = message;\n        result.inputNew = inputNew;\n      }\n\n      return result;\n    },\n    catchTriplet(triplet){\n      console.log(triplet)\n      // var subject = triplet.value.subject;\n      // var predicate = triplet.value.predicate;\n      // var object = triplet.value.object;\n\n      // console.log(message.length);\n      //message=message.trim();\n      //var tripletString = message.substring(2).trim().split(\" \");\n      // les noeuds existent-ils ?\n      // var sujetNode = this.network.body.data.nodes.get({\n      //   filter: function(node){\n      //     //    console.log(node);\n      //     return (node.label == subject );\n      //   }\n      // });\n      // var objetNode = this.network.body.data.nodes.get({\n      //   filter: function(node){\n      //     //    console.log(node);\n      //     return (node.label == object);\n      //   }\n      // });\n      //  console.log(sujetNode);\n      //  console.log(objetNode);\n      // sinon, on les créé\n      // if (sujetNode.length == 0){\n      //   var sub_n = {label: subject, color:{\n      //     border : document.getElementById(\"bordercolorpicker\").value ,\n      //     background : document.getElementById(\"bodycolorpicker\").value }\n      //   };\n      //   this.network.body.data.nodes.add(sub_n);\n      // }\n      // if (objetNode.length == 0){\n      //   var obj_n = {label: object, color:{\n      //     border : document.getElementById(\"bordercolorpicker\").value ,\n      //     background : document.getElementById(\"bodycolorpicker\").value }\n      //   };\n      //   this.network.body.data.nodes.add(obj_n);\n      // }\n      // // maintenant ils doivent exister, pas très po=ropre comme méthode , à revoir\n      // sujetNode = this.network.body.data.nodes.get({\n      //   filter: function(node){\n      //     return (node.label == subject );\n      //   }\n      // });\n      // objetNode = this.network.body.data.nodes.get({\n      //   filter: function(node){\n      //     //  console.log(node);\n      //     return (node.label == object);\n      //   }\n      // });\n      // this.network.body.data.edges.add({\n      //   label: predicate,\n      //   from : sujetNode[0].id,\n      //   to : objetNode[0].id,\n      //   color: {inherit:'both'}\n      //\n      // });\n      // //on récupère ce edge pour l'envoyer au serveur\n      // var edge = this.network.body.data.edges.get({\n      //   filter: function(edge) {\n      //     return (edge.from == sujetNode[0].id && edge.to == objetNode[0].id && edge.label == predicate);\n      //   }\n      // });\n      // console.log(\"EDGE\",edge)\n      //  console.log(\"OK\",autofit,autofocus)\n      //this.network.fit();\n      //  fitAndFocus(sujetNode[0].id);\n\n    },\n    // catchCommande(commande){\n    //   console.log(commande)\n    //\n    // },\n    updateInput(inputNew){\n      document.getElementById('input').value = inputNew || \"\";\n    },\n    isFile(pathname) {\n      return pathname.split('/').pop().indexOf('.') > -1;\n    },\n    isValidUrl(string){\n      try {\n        new URL(string);\n        return true;\n      } catch (_) {\n        return false;\n      }\n    }\n  },\n  watch:{\n    commandInput(){\n      console.log(this.commandInput)\n      this.main_input = this.commandInput\n    }\n  },\n  // computed: mapState({\n  //   main_input: s => s.ipgs.main_input\n  // }),\n  computed: {\n    commandInput: {\n      get () { return this.$store.state.ipgs.commandInput},\n      set (/*value*/) { /*this.updateTodo(value)*/ }\n    }\n  }\n\n}\n</script>\n\n<style>\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CommandInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CommandInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CommandInput.vue?vue&type=template&id=4fda2b32&\"\nimport script from \"./CommandInput.vue?vue&type=script&lang=js&\"\nexport * from \"./CommandInput.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}