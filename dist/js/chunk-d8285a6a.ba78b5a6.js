(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d8285a6a"],{"058a":function(e,t,n){},"2ca0":function(e,t,n){"use strict";var o=n("23e7"),r=n("06cf").f,i=n("50c4"),s=n("5a34"),a=n("1d80"),c=n("ab13"),d=n("c430"),u="".startsWith,l=Math.min,h=c("startsWith"),p=!d&&!h&&!!function(){var e=r(String.prototype,"startsWith");return e&&!e.writable}();o({target:"String",proto:!0,forced:!p&&!h},{startsWith:function(e){var t=String(a(this));s(e);var n=i(l(arguments.length>1?arguments[1]:void 0,t.length)),o=String(e);return u?u.call(t,o,n):t.slice(n,n+o.length)===o}})},"38b4":function(e,t,n){},"5a31":function(e,t,n){"use strict";n("058a")},"98a6":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper"},[n("network",{ref:"network",staticClass:"network",attrs:{id:"network",nodes:e.network.nodes,edges:e.network.edges,options:e.network.options},on:{"select-node":e.selectNodeEvent,"nodes-add":e.addNodeEvent}}),n("NetworkPopups",{attrs:{network:e.network}})],1)},r=[],i=(n("d3b7"),n("3ca3"),n("ddb0"),n("fb6a"),n("38b4"),n("1da1")),s=(n("4de4"),n("caad"),n("2532"),n("c740"),n("96cf"),n("178c")),a=n("00e8"),c=n.n(a),d=n("7fed"),u=n.n(d),l=new u.a(c.a),h={mixins:[s["a"]],data:function(){return{}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e,e.network.options.manipulation={initiallyActive:!0,addNode:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.label="",n.editNode(t,o);case 2:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),editNode:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.editNode(t,o);case 1:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),addEdge:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.addEdge(t,o);case 1:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),editEdge:{editWithoutDrag:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.editWithoutDrag(t,o);case 1:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()}};case 2:case"end":return t.stop()}}),t)})))()},methods:{onRemoveNodes:function(e){this.network.nodes=this.network.nodes.filter((function(t){return!e.properties.items.includes(t.id)})),this.sendUpdate(e)},onRemoveEdges:function(e){this.network.edges=this.network.edges.filter((function(t){return!e.properties.items.includes(t.id)})),this.sendUpdate(e)},sendUpdate:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.log(e),console.log(t.url),console.log(t.network),console.log("le json",t.json),void 0==t.json||"https://data.virtual-assembly.org/context.json"==t.json["@context"]){n.next=15;break}if(console.log("TODO must send only if different "),o=t.arraysEqual(t.json.nodes,t.network.nodes)&&t.arraysEqual(t.json.edges,t.network.edges),console.log("identiques",o),0!=o||void 0==t.url){n.next=15;break}return t.json.nodes=t.network.nodes,t.json.edges=t.network.edges,t.json.modified=new Date,console.log(t.json),n.next=15,l.createFile(t.json.url,JSON.stringify(t.json),"application/ld+json").then((function(e){console.log(e)}));case 15:case"end":return n.stop()}}),n)})))()},editNode:function(e,t){void 0==e.color&&(e.color={background:"#D2E5FF",border:"#2B7CE9"}),void 0==e.shape&&(e.shape="ellipse"),this.$store.commit("ipgs/setAction",{action:"editNode",node:e}),t()},addEdge:function(e,t){if(e.from==e.to){var n=confirm("Do you want to connect the node to itself?");if(1!=n)return void t(null)}this.editWithoutDrag(e,t)},editWithoutDrag:function(e,t){console.log(e);var n=e;n.from=void 0!=e.from.id?e.from.id:e.from,n.to=void 0!=e.to.id?e.to.id:e.to,this.$store.commit("ipgs/setAction",{action:"editEdge",edge:n}),t()},downloadCanvas:function(){var e=document.getElementById("network").childNodes[0].canvas;console.log(e);var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.fillStyle="#FFFFFF",n.fillRect(0,0,e.width,e.height),n.drawImage(e,0,0);var o=t.toDataURL(),r=document.createElement("a");r.download="image.png",r.href=o,document.body.appendChild(r),r.click(),document.body.removeChild(r)},onInputObjectChange:function(e){var t,n,o;switch(console.log("onCommand",e),e.type){case"triplet":t=this.nodeFromLabel(e.value.subject),this.saveNode(t),n=this.nodeFromLabel(e.value.object),this.saveNode(n),console.log(t.id,n.id),o=this.edgeFromLabel({from:t.id,to:n.id,label:e.value.predicate}),console.log(o),this.saveEdge(o);break;case"url":console.log(e);break;default:console.log("TODO",e)}},saveNode:function(e){var t=this.network.nodes.findIndex((function(t){return t.id==e.id}));-1===t?this.network.nodes.push(e):Object.assign(this.network.nodes[t],e),this.sendUpdate(e)},saveEdge:function(e){console.log(e);var t=this.network.edges.findIndex((function(t){return t.id==e.id}));-1===t?this.network.edges.push(e):Object.assign(this.network.edges[t],e),console.log(this.network),this.sendUpdate(e)}},computed:{action:{get:function(){return this.$store.state.ipgs.action},set:function(){}},inputObject:{get:function(){return this.$store.state.ipgs.inputObject},set:function(){}},newGraph:{get:function(){return this.$store.state.ipgs.newGraph},set:function(){}}},watch:{newGraph:function(){console.log("New Graph",this.newGraph),this.network.nodes=[],this.network.edges=[];var e=this.newGraph.node;e.id=this.newGraph.url,this.network.nodes.push(e);var t={type:"commande",value:"/e",inputNew:""};this.$store.commit("ipgs/setInputObject",t)},action:function(){switch(console.log(this.action),this.action.action){case"newGraph":this.network.nodes=[],this.network.edges=[];break;case"capture":this.downloadCanvas();break;default:}},inputObject:function(){this.onInputObjectChange(this.inputObject)}}},p=n("53ca"),g=n("3835"),f=(n("159b"),n("4fad"),n("498a"),n("2ca0"),n("8a79"),n("7db0"),["@context","id","label","pair:label","name","inbox","outbox","followers","following","publicKey","shape","type","title","color","image"]),w={methods:{addNodeEvent:function(e){var t=this,n=this.network.nodes.filter((function(t){return e.properties.items.includes(t.id)}));console.log(n),n.forEach(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(void 0!=n.built){e.next=3;break}return e.next=3,t.buildEdges(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},buildEdges:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var o,r,i,s,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=0,r=Object.entries(e);case 1:if(!(o<r.length)){n.next=8;break}return i=Object(g["a"])(r[o],2),s=i[0],a=i[1],n.next=5,t.parse(e,s,a);case 5:o++,n.next=1;break;case 8:e.built=!0;case 9:case"end":return n.stop()}}),n)})))()},parse:function(e,t,n){var o=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var i,s,a,c,d,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:"string"==typeof n?(n=n.trim(),i=o.network,!f.includes(t)&&n.length>0?(s=i.nodes.findIndex((function(e){return e.id==n})),-1===s&&(a={id:n,shape:"box"},n.length>50?(a.label=n.substring(0,50)+"..",a.title=n):a.label=n,n.startsWith("http")?(a.color="#7FD1B9",n.length>50?(c=n.endsWith("/")?n.slice(0,-1):n,a.label=c.substr(c.lastIndexOf("/")+1),a.title=n):a.label=n):a.color="#ECC046","type"==t&&(a.shape="star",a.color="#DE6E4B"),a.built=!0,i.nodes.push(a)),d=i.nodes.find((function(e){return e.id==n})),u={from:e.id,to:d.id,label:t},i.edges.push(u)):("pair:label"==t&&(e.label=n),"label"==t&&(e.label=n),"name"==t&&(e.label=n),"image"==t&&(e.shape="circularImage",e.image=n))):Array.isArray(n)?n.forEach((function(n){o.parse(e,t,n)})):f.includes(t)||console.log("TODO",Object(p["a"])(n),t,n);case 1:case"end":return r.stop()}}),r)})))()},selectNodeEvent:function(e){var t=e.nodes[0];if(console.log(t),t.startsWith("http"))this.$route.query.url!=t?this.$router.push({path:"/",query:{url:t}}):alert("you are already watching this resource !");else{var n=this.network.nodes.find((function(e){return e.id==t}));this.$store.commit("ipgs/setCommandInput",n.label+" ")}},networkClickEvent:function(e){console.log(e)},networkEvent:function(e){console.log(e)},graphsChanged:function(){console.log("GRAPHS CHANGED",this.graphs)}},watch:{graphs:function(){console.log(this.graphs),this.graphsChanged(),console.info("TEST WITH ONE GRAPH"),this.network=this.graphs[0]}},computed:{graphs:{get:function(){return this.$store.state.ipgs.graphs},set:function(){}}}},m=[{id:"n1",label:"Ipgs",color:{background:"red"},shape:"circle"},{id:"n2",label:"WebApp",color:{background:"green"},shape:"star"},{id:"n3",label:"InterPlanetary Graph System"},{id:"n4",label:"Mindmap App"},{id:"n5",label:"To know how to use Ipgs, type /h in the top input box and hit Enter",shape:"box"},{id:"n6",label:"Pour savoir comment utiliser Ipgs, tapez /h dans le champ de saisie tout en haut",shape:"box"}],b=[{id:"e1",from:"n1",to:"n2",label:"type"},{id:"e2",from:"n1",to:"n3",label:"long name"},{id:"e3",from:"n1",to:"n4",label:"category"},{id:"e4",from:"n1",to:"n5",label:"help EN"},{id:"e5",from:"n1",to:"n6",label:"help FR"}],v={name:"NetworkVis",mixins:[w,h],components:{NetworkPopups:function(){return n.e("chunk-2d215ca0").then(n.bind(null,"c063"))}},data:function(){return{network:{nodes:m.slice(0),edges:b.slice(0),options:{interaction:{navigationButtons:!0},nodes:{font:{color:"black"}},edges:{arrows:"to"}}}}}},k=v,j=(n("5a31"),n("2877")),x=Object(j["a"])(k,o,r,!1,null,null,null);t["default"]=x.exports}}]);
//# sourceMappingURL=chunk-d8285a6a.ba78b5a6.js.map