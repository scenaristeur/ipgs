(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21d8af"],{d26a:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"export-popup",size:"lg"}},[n("editor",{ref:"editor",attrs:{height:"300px",content:e.content,options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,tabSize:2},fontSize:14,lang:"python",theme:"eclipse"}},[n("div",[n("b-button-toolbar",{attrs:{"aria-label":"Toolbar with button groups and dropdown menu"}},[n("b-dropdown",{staticClass:"mx-1",scopedSlots:e._u([{key:"button-content",fn:function(){return[e._v(" "+e._s(e.format)+" ")]},proxy:!0}])},[n("b-dropdown-item",{on:{click:function(t){return e.onFormatChange("json")}}},[e._v("json")]),n("b-dropdown-item",{on:{click:function(t){return e.onFormatChange("ttl")}}},[e._v("ttl")]),n("b-dropdown-item",{on:{click:function(t){return e.onFormatChange("jsonld")}}},[e._v("jsonld")])],1),n("b-button-group",{staticClass:"mx-1"},[n("b-button",{on:{click:e.downloadFile}},[e._v("Download")]),n("b-button",{on:{click:e.save}},[e._v("Save")]),n("b-button",{on:{click:e.IpfsAdd}},[e._v("Save a copy on Ipfs")])],1)],1)],1)]),n("StorageModal"),n("IpfsModal",{attrs:{cid:e.cid}})],1)},r=[],a=n("1da1"),s=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("5530")),c=n("53ca"),i=(n("b64b"),n("caad"),n("2532"),n("d81d"),n("a15b"),n("ac1f"),n("1276"),n("498a"),n("159b"),n("5319"),n("7db0"),n("2b3d"),n("46bd")),u=n("5406"),d=n("89a1"),l=n("00e8"),p=n.n(l),f=n("7fed"),g=n.n(f),h=n("d305"),b=new g.a(p.a),m={methods:{arraysEqual:function(e,t){var n=this;return void 0!=e&&void 0!=t&&e.length===t.length&&e.every((function(e,o){return n.objectsEqual(e,t[o])}))},objectsEqual:function(e,t){var n=this;return"object"===Object(c["a"])(e)&&Object.keys(e).length>0?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every((function(o){return n.objectsEqual(e[o],t[o])})):e===t},loadFRAMED:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,b.readFile(e,{headers:{Accept:"application/ld+json","Content-Type":"application/ld+json"}});case 2:o=n.sent,r=JSON.parse(o),console.log("jsonFile",r),Array.isArray(r)&&1==r.length&&void 0!=r[0]["@id"]?t.parsePossibleJsonld(e,r[0]):Array.isArray(r)&&r.length>1?t.parseFolder(e):t.parsePossibleJsonld(e,r);case 6:case"end":return n.stop()}}),n)})))()},parseFolder:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.readFolder(e);case 2:n=t.sent,console.log("FOLDER",n);case 4:case"end":return t.stop()}}),t)})))()},parsePossibleJsonld:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var o,r,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("possible jsonld",e,t),o={"@context":{"@vocab":"http://example.org/"},"@type":"Library",contains:{"@type":"Book",contains:{"@type":"Chapter"}},"ldp:contains":{"@type":"Book","ldp:contains":{"@type":"Chapter"}},nodes:[],edges:[]},n.next=4,i["frame"](t,o);case 4:if(r=n.sent,console.log("FRAMED",r),a={},void 0==t["@context"]){n.next=16;break}return n.next=10,t["@context"];case 10:return s=n.sent,n.next=13,i["compact"](e,s);case 13:a=n.sent,n.next=19;break;case 16:return n.next=18,i["compact"](e,u["@context"]);case 18:a=n.sent;case 19:console.log("compacted loaded",a);case 20:case"end":return n.stop()}}),n)})))()},load:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var o,r,a,s,c,u,l,p;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("LOAD",e,!t.sockets.includes(e)),t.sockets.includes(e)||(t.sockets.push(e),o=new h["a"](e,t.load),console.log(o),console.log("SOCKETS",t.sockets)),console.log("LOAD 2",e,!t.sockets.includes(e)),r="xhr",n.next=6,i["useDocumentLoader"](r);case 6:return a={},n.prev=7,n.next=10,i["documentLoader"](e,(function(e){e&&console.log(e)}));case 10:a=n.sent,n.next=16;break;case 13:n.prev=13,n.t0=n["catch"](7),alert(n.t0);case 16:if(s=JSON.parse(a.document),console.log("JSON",s),t.json=s,void 0==s.nodes||!Array.isArray(s.nodes)||void 0==s.edges||!Array.isArray(s.edges)){n.next=26;break}return c=t.arraysEqual(t.json.nodes,t.network.nodes)&&t.arraysEqual(t.json.edges,t.network.edges),console.log("identiques",c),1!=c&&void 0!=t.url&&(t.network.nodes=s.nodes,t.network.edges=s.edges),n.abrupt("return",s);case 26:if(u={},void 0==s["@context"]){n.next=36;break}return n.next=30,s["@context"];case 30:return l=n.sent,n.next=33,i["compact"](e,l);case 33:u=n.sent,n.next=39;break;case 36:return n.next=38,i["compact"](e,d);case 38:u=n.sent;case 39:return console.log("compacted loaded",u),"vis"==u.type?(p=t.arraysEqual(t.json.nodes,t.network.nodes)&&t.arraysEqual(t.json.edges,t.network.edges),console.log("identiques",p),0==p&&void 0!=t.url&&(t.network.nodes=[],t.network.edges=[],Array.isArray(u.nodes)?t.network.nodes=u.nodes:t.network.nodes.push(u.nodes),Array.isArray(u.edges)?t.network.edges=u.edges:t.network.edges.push(u.edges))):"https://data.virtual-assembly.org/context.json"==u["@context"]&&(u["@context"]=[u["@context"]],u["@base"]=e,console.log(u),t.network=t.pairToVis(u)),console.log(t.network),n.abrupt("return",u);case 43:case"end":return n.stop()}}),n,null,[[7,13]])})))()},pairToVis:function(e){var t=[],n=[];console.log("base",e["@base"]),console.log(e["ldp:contains"]);var o=e["ldp:contains"].map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{label:e.id})}));return Array.isArray(o)?t=o:console.info("i cant deal with",o),{nodes:t,edges:n}},nodeFromLabel:function(e){return{id:"#"+e.trim().split(" ").join("_"),label:e,color:{background:"#D2E5FF",border:"#2B7CE9"},shape:"ellipse"}},edgeFromLabel:function(e){return{from:e.from,to:e.to,label:e.label}},jsonToJsonLd:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},Object.assign(n,e),n["@context"]=d,n.type="vis",t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))()},jsonToJsonLd1:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["compact"](e,d);case 2:return n=t.sent,n["@id"]="",n["@graph"]=[],e.nodes.forEach(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o={},Object.assign(o,t),o["@type"]="ipgs:Node",n["@graph"].push(o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.edges.forEach(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o={},Object.assign(o,t),o["@type"]="ipgs:Edge",o["from"]={"@id":t.from},o["to"]={"@id":t.to},n["@graph"].push(o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})))()},jsonToTtl:function(e){var t="@prefix : <http://smag0.blogspot.fr/spoggy#> . \n";t+="@prefix owl: <http://www.w3.org/2002/07/owl#> . \n",t+="@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> . \n",t+="@prefix xml: <http://www.w3.org/XML/1998/namespace> . \n",t+="@prefix xsd: <http://www.w3.org/2001/XMLSchema#> . \n",t+="@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> . \n",t+="@prefix smag: <http://smag0.blogspot.fr/spoggy#> . \n",t+="@base <http://smag0.blogspot.fr/spoggy> . \n",t+=" \n";for(var n=new Array,o=new Array,r=0;r<e.edges.length;r++){var a=e.edges[r],s=a.from,c=a.label.replace(/\s/g,"_"),i=a.to,u=e.nodes.find((function(e){return e.id==s})),d=e.nodes.find((function(e){return e.id==i})),l=u.label.replace(/\n/g,"");try{var p=d.label.replace(/\n/g,"")}catch(y){}var f=this.validRdf(s),g=this.validRdf(c),h=this.validRdf(i);-1==f.indexOf(":")&&(f="_:"+f),-1==g.indexOf(":")&&(g=":"+g),-1==h.indexOf(":")&&(h="_:"+h);var b=["owl:AnnotationProperty","owl:ObjectProperty","owl:DatatypeProperty"],m=1;"type"==g||":type"==g||"rdf:type"==g||":a"==g||":est_un"==g||":est_une"==g||":is_a"==g?(g="rdf:type",o.push(h+" rdf:type owl:Class . \n"),m=1):"subClassOf"==g||":subClassOf"==g||"rdfs:subClassOf"==g?g="rdfs:subClassOf":"sameAs"==g||":sameAs"==g?(g="owl:sameAs",m=-1):"ispartof"==g.toLowerCase()||"partof"==g.toLowerCase()||":partof"==g.toLowerCase()||":ispartof"==g.toLowerCase()?(g="smag:partOf",m=1):"comment"!=g.toLowerCase()&&"commentaire"!=g.toLowerCase()&&"//"!=g.toLowerCase()&&"#"!=g.toLowerCase()||(g="rdfs:comment",m=-1),m>=0&&o.push(g+" rdf:type "+b[m]+" . \n");var w=f+" "+g+" "+h+" . \n";w+=f+' rdfs:label "'+l+'" . \n',w+=h+' rdfs:label "'+p+'" . \n',n[r]=w}n=this.uniq_fast(n.sort()),o=this.uniq_fast(o.sort());for(var v=0;v<n.length;v++)t+=n[v];for(var x=0;x<o.length;x++)t+=o[x];return t},uniq_fast:function(e){for(var t={},n=[],o=e.length,r=0,a=0;a<o;a++){var s=e[a];1!==t[s]&&(t[s]=1,n[r++]=s)}return n},validRdf:function(e){var t={type:"uri"};return-1!==e.indexOf(" ")&&(t.type="literal"),e},downloadFile:function(){var e=this.content,t=this.format,n="",o="",r=prompt("Choose a name for the exported file :","Spoggy");if(null!=r&&""!=r){switch(t){case"json":n="application/json",o=r+".json";break;case"ttl":n="text/turtle",o=r+".ttl";break;case"jsonld":n="application/ld+json",o=r+".jsonld";break;default:alert("Format de fichier non reconnu",t)}var a=new Blob([e],{type:n}),s=document.createElement("a");s.download=o,s.innerHTML="Download File",-1!=navigator.userAgent.indexOf("Chrome")?s.href=window.URL.createObjectURL(a):(s.href=window.URL.createObjectURL(a),s.target="_blank",s.style.display="none",document.body.appendChild(s));var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(c),setTimeout((function(){document.body.removeChild(s),window.URL.revokeObjectURL(s)}),1e3)}}}},w=n("061c"),v=n.n(w),x=(n("2099"),n("8882"),n("8ef6"),n("1d29"),{name:"ExportModal",mixins:[m],components:{Editor:function(){return n.e("chunk-16a624a0").then(n.bind(null,"11f7"))},StorageModal:function(){return Promise.all([n.e("chunk-70fb2042"),n.e("chunk-56ba6d26"),n.e("chunk-61ade157")]).then(n.bind(null,"057d"))},IpfsModal:function(){return n.e("chunk-2d20f377").then(n.bind(null,"b34d"))}},data:function(){return{content:"content",format:"json",cid:""}},created:function(){this.editorContent=this.$store.state.ipgs.editorContent},mounted:function(){this.getIpfsNodeInfo()},methods:{fakeFunctionToNOTBELINTED:function(){console.log(v.a)},getIpfsNodeInfo:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$ipfs;case 3:return e.ipfs=t.sent,t.next=6,e.ipfs.id();case 6:n=t.sent,o=n.agentVersion,r=n.id,e.agentVersion=o,e.id=r,e.status="Connected to IPFS =)",t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),e.status="Error: ".concat(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))()},onFormatChange:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.format=e,console.log("FORMAT CHANGED",e),n.t0=t.format,n.next="json"===n.t0?5:"ttl"===n.t0?7:"jsonld"===n.t0?11:18;break;case 5:return t.content=JSON.stringify(t.editorContent.content,void 0,2),n.abrupt("break",19);case 7:return n.next=9,t.jsonToTtl(t.editorContent.content);case 9:return t.content=n.sent,n.abrupt("break",19);case 11:return n.t1=JSON,n.next=14,t.jsonToJsonLd(t.editorContent.content);case 14:return n.t2=n.sent,n.t3=void 0,t.content=n.t1.stringify.call(n.t1,n.t2,n.t3,2),n.abrupt("break",19);case 18:console.warn("UNKNOWN FORMAT",e);case 19:case"end":return n.stop()}}),n)})))()},IpfsAdd:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.ipfs),console.log(e.editorContent.content),t.next=4,e.ipfs.add(JSON.stringify(e.editorContent.content));case 4:return n=t.sent,console.log("res",n),t.t0=console,t.next=9,n.cid;case 9:t.t1=t.sent,t.t0.log.call(t.t0,t.t1),e.cid=n.cid,e.$bvModal.show("ipfs-modal");case 13:case"end":return t.stop()}}),t)})))()},save:function(){console.log("save"),this.$store.commit("ipgs/setDataToSave",{content:this.content,format:this.format}),this.$bvModal.show("storage-modal")}},watch:{editorContent:function(){console.log(this.editorContent),this.content=JSON.stringify(this.editorContent.content,void 0,2),this.format=this.editorContent.format}},computed:{editorContent:{get:function(){return this.$store.state.ipgs.editorContent},set:function(){}}}}),y=x,k=n("2877"),j=Object(k["a"])(y,o,r,!1,null,null,null);t["default"]=j.exports}}]);
//# sourceMappingURL=chunk-2d21d8af.58cd572a.js.map